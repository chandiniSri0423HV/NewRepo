pipeline {
    agent any
    parameters {
        string(name: "FileName", defaultValue: "Deactivate.json", description: "FileName")
		string(name: "IntegrationName", defaultValue: "NEWINTEGRATION_NEWREPO_01.00.0000", description: "IntegrationName")
        string(name: "BasicAuthentication", defaultValue: "Basic ZGV2b3BzX3VzZXI6T2ljX0plbmtpbnMjMjAyMw==", description: "BasicAuthentication")
		string(name: "API_URL", defaultValue: "https://testinstance-idevjxz332qf-ia.integration.ocp.oraclecloud.com/ic/api/integration/v1/integrations/", description: "API_URL")

    }
    stages {
        stage("Integration Deployment") {
            steps {
                echo "$params.IntegrationFileName"
				echo "$BasicAuthentication"
				echo "${IntegrationArchiveURL}"
				bat'''
				curl --location "https://testinstance-idevjxz332qf-ia.integration.ocp.oraclecloud.com/ic/api/integration/v1/integrations/archive" --header "Authorization: Basic cG9jdXNlcjpIVk9JQ01heSMyMDIz" --form "file=@"NEWINTEGRATION_NEWREPO_01.00.0000.iar"
				'''
				bat'''
				curl -X POST --header "Authorization: ${params.BasicAuthentication}" --header "Content-Type:application/json" --header "X-HTTP-Method-Override:PATCH" -d @${params.FileName} -d 'enableAsyncActivationMode=true' "${params.API_URL}${params.IntegrationName}"
				'''
            }
        }
        
    }
}