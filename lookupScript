pipeline {
    agent any
    
    parameters {
        string(defaultValue: '1', description: 'Number of files', name: 'NumberOfFiles')
        string(description: 'Lookup file names (comma-separated)', name: 'LookupFileName')
    }
    
    stages {
        stage('Execution') {
            steps {
                script {
                    def files = params.LookupFileName.split(',')
                    
                    for (int i = 0; i < files.size(); i++) {
                        def fileName = files[i].trim()
                        
                        if (fileName) {
                            // Execute curl command for each lookup file name
                            sh """
                                curl -X POST --user \${Username}:\${Password} -F "file=@${fileName}" -F "type=application/octet-stream" \${instanceURL}/ic/api/integration/v1/lookups/archive
                            """
                        }
                    }
                }
            }
        }
    }
}
